[tool.ruff]

exclude = [
    ".git",
    ".hg",
    ".mypy_cache",
    ".tox",
    ".venv",
    "_build",
    "buck-out",
    "build",
    "dist",
    ".*/snapshots",
]

lint.ignore = [
    "D100", # Missing docstring in public module
    "D101", # Missing docstring in public class
    "D102", # Missing docstring in public method
    "D103", # Missing docstring in public function
    "D104", # Missing docstring in public package
    "D105", # Missing docstring in magic method
    "D106", # Missing docstring in public nested class
    "D107", # Missing docstring in __init__
    "E501", # Line too long (92 > 88)
    "D202", # No blank lines allowed after function docstring
    "D212", # Multi-line docstring summary should start at the first line
    "D213", # Multi-line docstring summary should start at the second line
    "D407", # Missing dashed underline after section
    "D406", # Section name should end with a newline
    "D203", # one-blank-line-before-class (docstring)
    "D413", # Missing blank line after last section
]

line-length = 88


lint.select = ["C9", "D", "E", "F", "W", "I"]

[tool.ruff.lint.mccabe]
max-complexity = 11

[tool.ruff.lint.isort]
combine-as-imports = true

[tool.pytest.ini_options]
addopts = "--reuse-db --randomly-seed=1521188766 --randomly-dont-reorganize"
DJANGO_SETTINGS_MODULE = "emeis.settings"
filterwarnings = [
    "error::DeprecationWarning",
    "error::PendingDeprecationWarning",
    # We don't use LocalizedAutoSlug, but it still keeps warning, so we ignore it for now
    "ignore:LocalizedAutoSlug is deprecated and will be removed in the next major version.",
]
env = [
    "ADMINS=Test Example <test@example.com>,Test2 <test2@example.com>",
    "LANGUAGES=en,de,fr",
    "OIDC_OP_USER_ENDPOINT=mock://emeis.github.com/openid/userinfo",
    "OIDC_OP_INTROSPECT_ENDPOINT=mock://emeis.github.com/openid/introspect",
    "OIDC_BEARER_TOKEN_REVALIDATION_TIME=60",
]

[coverage.run]
source="."

[coverage.report]
fail_under=100
exclude_lines = [
    "pragma: no cover",
    "pragma: todo cover",
    "def __str__",
    "def __unicode__",
    "def __repr__",
]
omit= [
    "*/migrations/*",
    "*/apps.py",
    "manage.py",
    "setup.py",
    "emeis/settings_*.py",
    "emeis/wsgi.py",
    "emeis/emeis_metadata.py",
]
show_missing = true
